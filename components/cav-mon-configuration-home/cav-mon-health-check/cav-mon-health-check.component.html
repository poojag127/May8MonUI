<p-dialog class="profile-dialog monitor-dialog" [(visible)]="displayDialog"  header="Health Check Monitor Configurations" width="1000"  
   [modal]="false" (onHide)="dialogCloseEvent($event)" [resizable]="true" [responsive]="true">

<div class = "ui-g-12">
  <p-accordion class="monitor-ui-accordion">
   <p-accordionTab header="Global Settings">
    <p-fieldset  class = "healthChkMonCss" legend="Ping Health Check Settings" [toggleable]="true" collapsed="true">
      <div class= "ui-g-12">
        <div class="ui-g-2">
          <label>Packet Count</label>
       </div>
       <div class ="ui-g-2" style="margin-left: -44px">
         <input name="pckt" style="width: 80%;" type="number" pInputText [(ngModel)]="globalProps.pingPkt" ngModel />
       </div>

      <div class = "ui-g-2">
        <label>Wait Interval</label>
      </div>
      <div class ="ui-g-2" style="margin-left: -44px">
        <input name="interval" style="width: 80%;" type="number"  pInputText [(ngModel)]="globalProps.pingIntrvl" ngModel />
        <span>
            (ms)
        </span>
      </div>

      <div class="ui-g-2"  style="margin-left: 21px;">
        <label>Thread Pool Size</label>
      </div>
      <div class = "ui-g-2">
         <input name="threadPool" style="width: 80%;" type="number"  pInputText [(ngModel)]="globalProps.pingTP"  ngModel />
       </div>
     </div>
  </p-fieldset>

<p-fieldset  class = "healthChkMonCss" legend="HTTP  Health Check Settings" [toggleable]="true" collapsed="true">
  <div class = "ui-g-12">
    <div class = "ui-g-2">
       <p-checkbox [(ngModel)]="heathCheckMonData.useProxy"  name="proxy" binary=true label="Use Proxy" ></p-checkbox>
     </div>
   </div>

  <div class= "ui-g-12" style="margin-left: 14px">
    <div class= "ui-g-12">
      <div class="ui-g-2">
         <label>Proxy Host:Port </label>
     </div>
     <div class ="ui-g-2" style="margin-left: -47px;">
       <input name="globalUrl" type="text" [disabled]="!heathCheckMonData.useProxy"  
          pInputText [(ngModel)]="globalProps.httpUrl"  required ngModel />
     </div>

    <div class = "ui-g-2" style="margin-left: 46px;">
        <label>User Name</label>
    </div>
    <div class ="ui-g-2" style="margin-left: -61px">
         <input name="globalUser" type="text"  [disabled]="!heathCheckMonData.useProxy" 
          pInputText [(ngModel)]="globalProps.httpUser" 
         autofocus required pattern="^[a-zA-Z][a-zA-Z0-9_-]{0,31}$" required ngModel />
    </div>

      <div class = "ui-g-2"  style="margin-left: 46px;">
          <label>Password</label>
        </div>
        <div class ="ui-g-2" style="margin-left: -61px">
           <input name="globalpasswrd" type="password"  [disabled]="!heathCheckMonData.useProxy"
               pInputText [(ngModel)]="globalProps.httpPwd">
        </div>
    </div>

  <div class= "ui-g-12">
      <div class = "ui-g-2">
        <label>Connection Time Out</label>
      </div>
      <div class ="ui-g-2">
        <input name="timeOut" type="number" style="width: 77%" pInputText [(ngModel)]="globalProps.httpCTO" ngModel/>
        <span>
            (sec)
        </span>
      </div>

            
      <div class = "ui-g-2" style = "margin-left: -2px">
          <label>Response Time </label>
        </div>
        <div class ="ui-g-2" >
            <input name="timeOut" type="number" style="width: 70% ; margin-left:-58px" pInputText [(ngModel)]="globalProps.httpRTO" ngModel/>
            <span>
                (sec)
            </span>
        </div>

        <div class="ui-g-2" style="margin-left: -14px">
            <label>Thread Pool Size</label>
          </div>
          <div class = "ui-g-2" style="margin-left: -59px">
             <input name="threadPool"  style="width: 70%"  type="number"  pInputText [(ngModel)]="globalProps.httpTP"  ngModel />
           </div>
    </div>
  
  <div class= "ui-g-12" style="margin-left: 5px">
        <label>Status Code for successful health check</label>
    <span>
      <input name="globalStatusCode" style="margin-left: 29px" type="text"  pInputText    [(ngModel)]="globalProps.httpSc"  ngModel />
    </span>
  </div>
  </div>
</p-fieldset>

<p-fieldset class = "healthChkMonCss" legend="Socket Health Check Settings" [toggleable]="true" collapsed="true">
  <div class = "ui-g-12">
    <div class = "ui-g-1" style="width:14.3333%">
      <label>Connection Time Out</label>
     </div>
     <div class ="ui-g-3">
       <input name="socketCTO" type="number" min="0"  pInputText [(ngModel)]="globalProps.socketTo" ngModel /> 
       <span>
          (sec)
      </span>
    </div>
  </div>    
</p-fieldset>
</p-accordionTab>
</p-accordion>

<p-accordion class="monitor-ui-accordion" >
<p-accordionTab header="Health Check Configuration Data" [selected]= "true">
    <form  (ngSubmit)="saveData()" #form="ngForm" ngNativeValidate >
        <p-fieldset  class = "healthChkMonCss"  legend="Configuration" [toggleable]="true"  [collapsed] = "true">
          <div class = "ui-g-12" style="margin-top: 6px">
            
    <div class = "ui-g-12">
     <div class = "ui-g-2">
        <label>
        Select Tier
        </label>  
     </div>
      
    <div class ="ui-g-3" >
      <p-dropdown [style]="{'width':'150px'}" name="list" required
          (onChange) = "onTierChange(heathCheckMonData.tierName)"
            [options]="tierList" placeholder= "--Select Tier--" [(ngModel)]="heathCheckMonData.tierName" >
      </p-dropdown>
    </div>
          
    <div class ="ui-g-3"  [hidden] ="heathCheckMonData.tierName != 'Others'" >
        <label>
          Tier Name
        </label>
      <span>
          <input name="tierName" type="text" pInputText [(ngModel)]="heathCheckMonData.customTierName" title="Enter tier name" required ngModel />
      </span>
       
    </div>

    <div class = "ui-g-2" [hidden] ="heathCheckMonData.tierName == 'Others'" >
      <label>
          Select Server
      </label>  
    </div>
    
     <div class ="ui-g-3" [hidden] ="heathCheckMonData.tierName == 'Others'" >
        <p-dropdown [style]="{'width':'150px'}" name="lists" required
            [disabled]="heathCheckMonData.tierServerType == 'custom' || heathCheckMonData.tierName == '' ||heathCheckMonData.tierName == 'Others'" placeholder= "-- Select Server--"  [options]="serverList" [(ngModel)]="heathCheckMonData.serverName" >
          </p-dropdown>
      </div>

      <div class ="ui-g-3" [hidden] ="heathCheckMonData.tierName != 'Others'">
        <label>
           Server Name
        </label>
       <span>
          <input name="serverName" type="text" [disabled]="heathCheckMonData.tierName != 'Others'" pInputText [(ngModel)]="heathCheckMonData.customServerName"  title = "Enter server name" ngModel /></span> 
       </div>
    
    </div>
   <div class = "ui-g-12">
       <div class = "ui-g-2">
           <label>
             Health Check Type
           </label>
       </div>

             <div class = "ui-g-3" >
                  <p-dropdown name="healthChkList"  [style]="{'width':'120px'}"
                    [options]="healthCheckList" [(ngModel)]="heathCheckMonData.healthCheckType" >
                   </p-dropdown>
              </div>

           <div class = "ui-g-2" style="margin-left: -29px" [hidden] = "heathCheckMonData.healthCheckType == 'HTTP'">
               <label>Host</label>
             </div>
             <div class ="ui-g-3" style="margin-left: -81px" [hidden] = "heathCheckMonData.healthCheckType == 'HTTP'"> 
                <input name="host" type="text" [disabled]="heathCheckMonData.healthCheckType == 'HTTP'" pInputText [(ngModel)]="heathCheckMonData.host" ngModel />
             </div>
      
             <div class = "ui-g-2" style="margin-left: -27px" [hidden] = "heathCheckMonData.healthCheckType != 'Socket'">
                <label>Port</label>
              </div>
              <div class = "ui-g-3" style="margin-left: -83px"  [hidden] = "heathCheckMonData.healthCheckType != 'Socket'">
                 <input name="port" type="text" [disabled]="heathCheckMonData.healthCheckType == 'Ping' || heathCheckMonData.healthCheckType == 'HTTP' " pInputText [(ngModel)]="heathCheckMonData.port" ngModel />
              </div>

             
         </div>

          <!-- <div class = "ui-g-12">
              <div class = "ui-g-2">
            <label>
                Health Check Type
            </label>
         </div>
        
         
         <div class = "ui-g-3">
              <p-dropdown name="healthChkList"  [style]="{'width':'120px'}"
                [options]="healthCheckList" [(ngModel)]="heathCheckMonData.healthCheckType" >
               </p-dropdown>
          </div>
        </div> -->
      
      
         <div class = "ui-g-12">
            <p-accordion class="monitor-ui-accordion">
                <p-accordionTab header="Advance Settings">
                 <div class = "ui-g-12" style= "border: 1px solid" [hidden]='heathCheckMonData.healthCheckType != "Ping"'>
                   <div class="ui-g-1">
                     <label>Packet</label>
                   </div>
                 <div class = "ui-g-3">
                   <input name="packet" type="number"  pInputText [(ngModel)]="heathCheckMonData.pingPkt" autofocus required ngModel />
                 </div>
<!--       
                 <div class = "ui-g-1">
                    <label>Host</label>
                  </div>
                <div class ="ui-g-3">
                  <input name="host" type="text"  pInputText [(ngModel)]="heathCheckMonData.hostName"  ngModel />
                </div>
       -->
                   <div class = "ui-g-1">
                     <label>Interval</label>
                   </div>
                 <div class ="ui-g-3">
                   <input name="interval" type="number"  pInputText [(ngModel)]="heathCheckMonData.pingIntrvl"  ngModel />
                 </div>
                 
             </div>    
             
             <div class = "ui-g-12" style= "border: 1px solid" [hidden]='heathCheckMonData.healthCheckType != "Socket"'>
                <div class="ui-g-1">
                  <label>Thread Pool</label>
                </div>
              <div class = "ui-g-3">
                <input name="threadPool" type="number"  pInputText [(ngModel)]="heathCheckMonData.socketTP"  ngModel />
              </div>
      
              <!-- <div class = "ui-g-1">
                  <label>Host</label>
                </div>
                <div class ="ui-g-3">
                   <input name="host" type="text"  pInputText [(ngModel)]="heathCheckMonData.hostName"
                     ngModel />
                </div>
       -->
                <!-- <div class = "ui-g-1">
                    <label>Port</label>
                  </div>
                  <div class ="ui-g-3">
                     <input name="port" type="number"  pInputText [(ngModel)]="heathCheckMonData.port"
                       ngModel />
                  </div> -->
              
              <div class = "ui-g-1">
                  <label>Instance</label>
                </div>
                <div class ="ui-g-3">
                   <input name="inst" type="text"  pInputText [(ngModel)]="heathCheckMonData.instanceName"
                     ngModel />
                </div>
      
                <div class = "ui-g-1">
                  <label>Time Out</label>
                </div>
              <div class ="ui-g-3">
                <input name="connectionTimeOut" type="number"  pInputText [(ngModel)]="heathCheckMonData.socketTo" 
                ngModel />
              </div>

          </div>     
      
          <div class= "ui-g-12" style= "border: 1px solid" [hidden]='heathCheckMonData.healthCheckType != "HTTP"'>
              <div class="ui-g-1">
                 <label>Proxy URL </label>
              </div>
              <div class ="ui-g-3">
                <input name="url" type="text"  pInputText [(ngModel)]="heathCheckMonData.httpUrl"   ngModel />
              </div>
      
              <div class = "ui-g-1">
                <label>User Name</label>
              </div>
              <div class ="ui-g-3">
                 <input name="user" type="text"  pInputText [(ngModel)]="heathCheckMonData.httpUser" 
                   pattern="^[a-zA-Z][a-zA-Z0-9_-]{0,31}$"  ngModel />
              </div>
      
               <div class = "ui-g-1">
                <label>Password</label>
              </div>
              <div class ="ui-g-3">
                 <input name="passwrd" type="password"
                  pInputText [(ngModel)]="heathCheckMonData.httpPwd" 
                   ngModel />
              </div>
      
              <div class = "ui-g-1">
                <label>Thread Pool</label>
              </div>
              <div class ="ui-g-3">
                 <input name="threadPool" type="number"  pInputText [(ngModel)]="heathCheckMonData.httpTP"
                  ngModel />
              </div>
      
              <div class = "ui-g-1">
                  <label>Status Code</label>
                </div>
                <div class ="ui-g-3">
                   <input name="statusCode" type="text"  pInputText title="Comma separated values other than 200 status code"
                   [(ngModel)]="heathCheckMonData.httpSc" ngModel />
                </div>
            </div>
          </p-accordionTab>       
        </p-accordion>   
      </div>


      <div class="ui-g-12" style="margin-top: 7px">
          <button type="submit" pButton icon="fa-check" style="width: 63px ; float: right" label="Add"></button>
        </div>
      </div>
  </p-fieldset>
  </form>

<div class = "ui-g-12" style="margin-top: -3px">
 <p-treeTable  class = "healthChk-treeTable" [value]="heathCheckMonitorData"  selectionMode="single" [(selection)]="selectedFile">
    <!-- <p-header style="background: black">Configured Health Check Monitor Data</p-header> -->
    <p-header class="health-check-mon-header">
        <span >Configured Health Check Monitor Data</span>
     </p-header>

   <p-column field="nodeName" header="Name"></p-column>
   <p-column field="arguments" header="Arguments">
      <template let-col let-data="rowData" pTemplate>
              <p-checkbox *ngIf="data.data['arguments'] == 'false' ||data.data['arguments'] == 'true'|| data.data['arguments'] == false ||data.data['arguments'] == true" 
              [(ngModel)]="data.data.enabled "
              (click)="onCheckBoxChange(data,data.data.enabled)"  binary="false">
              </p-checkbox>   
                <span *ngIf="!(data.data['arguments'] == 'false' ||data.data['arguments'] == 'true' || data.data['arguments'] == false ||data.data['arguments'] == true)" >{{data.data['arguments']}}</span>
      </template>
   </p-column>
   
   <p-column [style]="{'width':'100px'}" field="Actions" header="Actions">
      <template  let-data="rowData" pTemplate type="body">
          <a (click)="editHealthMonData(data)">
              <i class="fa fa-pencil" style="color: #2572b5;cursor:pointer; margin-left: 30px" title="Edit Configured Data"></i>
          </a>
            <span  (click)="deleteHealthMonData(data)">
                <i class="fa fa-trash-o" style="color: #f12a2a;cursor:pointer; margin-left: 11px" title="Delete Configured Monitor"></i>
            </span>
      </template>
   </p-column>
</p-treeTable>
</div>
</p-accordionTab>
</p-accordion>
</div>


<div class="ui-g-12">
<button type="button" pButton  icon="fa-check" style="float: right" (click)= "finalSubmit()" title="Done" label="Done"></button>
<button type="button" pButton  icon="fa-close" style="float: right" (click)= "dialogCloseEvent()" label="Cancel" title="Close"></button>
</div>
</p-dialog>