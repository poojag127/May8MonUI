<p-dialog class="profile-dialog monitor-dialog" 
  [(visible)]="displayDialog" [style]="{'overflow': 'hidden','max-height': '520px'}"
   header="Health Check Monitor Configurations" width="1000"  
   [modal]="false" (onHide)="dialogCloseEvent($event)" [resizable]="true" [responsive]="true">




<p-tabView  class="monitor-ui-tab">

<p-tabPanel header="Health Check Settings">

<div class = "ui-g-12" style="margin-bottom: 10px; margin-left: 10px;">
  <p-checkbox [(ngModel)]="enableHealthCheckMon" name="enableChkMon" binary="true" label="Enable Health Check Monitor" ></p-checkbox>
</div>

<!--<form #form="ngForm" ngNativeValidate >-->
  <div>
    <p-fieldset  class ="healthChkMonCss" legend="Ping Health Check Settings" [toggleable]="true" collapsed="true">
      <div class= "ui-g-12">
        <div class="ui-g-2" style="margin-top: 2px;">
           <label>Packet Count</label>
        </div>
        <div class ="ui-g-1" style="margin-left: -68px;">
          <input name="pckt" style="width: 55px;" type="number" min="0" max="100" 
          required
          pInputText [(ngModel)]="globalProps.pingPkt" ngModel />
         </div>
        
          <div class = "ui-g-2" style="margin-top: 2px; margin-left: 48px">
            <label>Wait Interval in sec(s)</label>
          </div>
           <div class ="ui-g-1" style="margin-left: -23px;">
              <input name="intvrl" style="width: 55px;" type="number" step="0.1" min="0" max="1" pInputText [(ngModel)]="globalProps.pingIntrvl" ngModel />
           </div>
        
          <div class="ui-g-2" style="margin-top: 2px; margin-left: 48px">
             <label>Thread Pool Size</label>
          </div>
          <div class = "ui-g-1" style="margin-left: -50px;">
              <input name="tpSize" style="width: 55px;" type="number"  pInputText [(ngModel)]="globalProps.pingTP"  ngModel />
          </div>
        </div>
    </p-fieldset>
        
        <p-fieldset  class = "healthChkMonCss" legend="HTTP  Health Check Settings" [toggleable]="true" collapsed="true">
          <div class = "ui-g-12">
            <div class = "ui-g-2">
               <p-checkbox [(ngModel)]="globalProps.useProxy"  name="proxy" binary=true label="Use Proxy" ></p-checkbox>
             </div>
           </div>
        
          <div class= "ui-g-12" style="margin-left: 13px;">
            <div class= "ui-g-12">
              <div class="ui-g-2" style="margin-top: 2px;">
                 <label>Proxy Host:Port </label>
             </div>
             <div class ="ui-g-2" style="margin-left: -47px">
               <input name="globalUrl" type="text" [disabled]="!globalProps.useProxy"  
                  pInputText [(ngModel)]="globalProps.httpUrl"  required ngModel />
             </div>
        
            <div class = "ui-g-2" style="margin-left: 46px; margin-top: 2px">
                <label>User Name</label>
            </div>
            <div class ="ui-g-2" style="margin-left: -61px">
                 <input name="globalUser" type="text"  [disabled]="!globalProps.useProxy" 
                   pInputText [(ngModel)]="globalProps.httpUser" 
                 autofocus required pattern="^[a-zA-Z][a-zA-Z0-9_-]{0,31}$" required ngModel />
            </div>
        
              <div class = "ui-g-2"  style="margin-left: 46px;margin-top: 2px">
                  <label>Password</label>
                </div>
                <div class ="ui-g-2" style="margin-left: -61px">
                   <input name="globalpasswrd" type="password"  [disabled]="!globalProps.useProxy"
                       pInputText [(ngModel)]="globalProps.httpPwd">
                </div>
            </div>
          </div>
        
          <div class= "ui-g-12">
              <div class = "ui-g-2" style="width: 20%; margin-top: 2px">
                <label>Connection Timeout in sec(s)</label>
              </div>
              <div class ="ui-g-2" style="margin-left: -13px;">
                <input name="timeOut" type="number" style="width: 55px" pInputText [(ngModel)]="globalProps.httpCTO" ngModel/>
              </div>
        
                    
              <div class = "ui-g-2" style = "margin-left: 9px; margin-top: 2px">
                  <label>Response Timeout in sec(s)</label>
                </div>
                <div class ="ui-g-2" style="margin-left: 29px">
                    <input name="resTimeOut" type="number" style="width: 55px" pInputText [(ngModel)]="globalProps.httpRTO" ngModel/>
                </div>
        
                <div class="ui-g-2" style="margin-left: -58px; margin-top: 2px">
                    <label>Thread Pool Size</label>
                  </div>
                  <div class = "ui-g-2" style="margin-left: -34px">
                     <input name="threadPool"  style="width: 55px;" type="number"  pInputText [(ngModel)]="globalProps.httpTP"  ngModel />
                   </div>
            </div>
          
          <div class= "ui-g-12" style="margin-left: 5px">
                <label>Status code for successful health check</label>
            <span>
              <input name="globalStatusCode" style="margin-left: 29px" type="text"  pInputText  title="Comma separated list of status code"  [(ngModel)]="globalProps.httpSc"  ngModel />
            </span>
          </div>
        
        </p-fieldset>
        
        <p-fieldset class = "healthChkMonCss" legend="Socket Health Check Settings" [toggleable]="true" collapsed="true">
          <div class = "ui-g-12">
            <div class ="ui-g-2" style="width: 18%; margin-top: 2px">
              <label>Connection Timeout in sec(s)</label>
             </div>
             <div class ="ui-g-3">
               <input name="socketCTO" type="number" style="width: 55px;" min="0"  pInputText [(ngModel)]="globalProps.sockeTo" ngModel /> 
            </div>
          </div>    
        </p-fieldset>
      </div>

      <!--<div class="ui-g-12">
            <button type="submit" pButton  icon="fa-check" style="float: right"  title="Save" label="Save"></button>
            <button type="button" pButton  icon="fa-close" style="float: right" (click)= "dialogCloseEvent()" label="Cancel" title="Close"></button>
      </div>-->
    <!--</form>-->

</p-tabPanel>


     <p-tabPanel header="Health Check Monitor">
          <form  (ngSubmit)="saveData()" #form="ngForm" ngNativeValidate >
              <p-fieldset  class = "healthChkMonCss"  legend="Configuration" [toggleable]="true"  [collapsed] = "false">
                <div class = "ui-g-12" style="margin-top: 6px">
                      
             <div class = "ui-g-12">
                <div class = "ui-g-2" style="margin-top: 2px">
                    <label>
                      Health Check Type
                    </label>
                </div>
          
                <div class = "ui-g-3" style="margin-left: -38px">
                  <p-dropdown name="healthChkList"  [style]="{'width':'120px'}"   [disabled]="editMode"
                    [options]="healthCheckList" [(ngModel)]="heathCheckMonData.healthCheckType" >
                  </p-dropdown>
               </div>
            </div>
          
            <div class = "ui-g-12">
              <div class = "ui-g-1" style="margin-top: 2px">
               <label>
                 Tier
                </label>  
              </div>
                
               <div class ="ui-g-2" >
                 <p-dropdown [style]="{'width':'150px'}" name="list" required
                     [disabled] = "editMode"
                    (onChange) = "onTierChange(heathCheckMonData.tierName)"
                      [options]="tierList" placeholder= "--Select Tier--" [(ngModel)]="heathCheckMonData.tierName" >
                 </p-dropdown>
               </div>
                    
              <!-- <div class ="ui-g-2" style="width: 10%; margin-left: -26px" [hidden] ="heathCheckMonData.tierName != 'Others'">
                <label>
                  Tier Name
                </label>
              </div> -->
              <div class ="ui-g-2" >
                   <input name="tierName" style="margin-left: 19px" [disabled]="heathCheckMonData.tierName != 'Others'||editMode" 
                   type="text" pInputText [(ngModel)]="heathCheckMonData.customTierName" title="Enter tier name" required ngModel />
              </div>
          
              <div class = "ui-g-1" style="margin-left: 73px; margin-top: 2px">
                <label>
                  Server
                </label>  
              </div>
              
               <div class ="ui-g-2" >
                  <p-dropdown [style]="{'width':'150px'}" name="lists" required
                      [disabled]="heathCheckMonData.tierName == '' ||heathCheckMonData.tierName == 'Others'||editMode" placeholder= "-- Select Server--"  [options]="serverList" [(ngModel)]="heathCheckMonData.serverName" >
                    </p-dropdown>
                </div>
          
                <div class ="ui-g-2">
                    <input name="serverName" style="margin-left: 19px" type="text" [disabled]="heathCheckMonData.tierName != 'Others' ||editMode"
                     pInputText [(ngModel)]="heathCheckMonData.customServerName"  title = "Enter server name" ngModel />
                </div>
          </div>
          
          <!-- 
           <div class = "ui-g-12">
              <div class ="ui-g-2">
                <label>
                  Enter Tier Name
                </label>
              </div>
              <div class ="ui-g-3" >
                   <input name="tierName" type="text" [disabled]="heathCheckMonData.tierName != 'Others'"
                    pInputText [(ngModel)]="heathCheckMonData.customTierName" title="Enter tier name" required ngModel />
              </div>
          
                <div class ="ui-g-2">
                  <label>
                    Enter Server Name
                  </label>
                </div>
                  <div class ="ui-g-3">
                    <input name="serverName" type="text" [disabled]="heathCheckMonData.tierName != 'Others'"
                     pInputText [(ngModel)]="heathCheckMonData.customServerName"  title = "Enter server name" ngModel />
                  </div>
          
            </div>  -->
          <!--     
             <div class = "ui-g-12">
                 <div class = "ui-g-2">
                     <label>
                       Health Check Type
                     </label>
                 </div>
          
                 
                       <div class = "ui-g-3" style="margin-left: -38px">
                            <p-dropdown name="healthChkList"  [style]="{'width':'120px'}"
                              [disabled]="editMode"
                              [options]="healthCheckList" [(ngModel)]="heathCheckMonData.healthCheckType" >
                             </p-dropdown>
                        </div>
             </div> -->
             <div class = "ui-g-12">
              <div class = "ui-g-2" style="margin-top: 2px"  *ngIf = "heathCheckMonData.healthCheckType != 'Http'" >
                <label>Host</label>
               </div>
               <div class = "ui-g-2"  style="margin-left: -74px" *ngIf = "heathCheckMonData.healthCheckType != 'Http'" >
                  <input name="host" 
                      [disabled]="heathCheckMonData.healthCheckType == 'Http' "
                      type="text"  pInputText [(ngModel)]="heathCheckMonData.host"  autofocus required ngModel />
               </div>
          
              <div class = "ui-g-2" style="margin-left: 73px; margin-top: 2px " *ngIf = "heathCheckMonData.healthCheckType == 'Socket' ">
                <label>Port</label>
              </div>
              <div class = "ui-g-3" *ngIf = "heathCheckMonData.healthCheckType == 'Socket'" style="margin-left: -68px">
                   <input name="port" type="number" min="1" max="65535"
                   autofocus required pInputText [(ngModel)]="heathCheckMonData.port" ngModel />
              </div>
          
              <div class = "ui-g-2"  style="margin-top: 2px " *ngIf = "heathCheckMonData.healthCheckType != 'Ping'" >
                  <label>Instance</label>
                </div>
                <div class ="ui-g-2" style="margin-left: -74px">
                   <input name="instnce" type="text"  *ngIf = "heathCheckMonData.healthCheckType != 'Ping'"  pInputText  [(ngModel)]="heathCheckMonData.instName"
                     ngModel />
              </div>
           </div>
          
           <div class = "ui-g-12" *ngIf ="heathCheckMonData.healthCheckType != 'Ping'">
              <div class = "ui-g-2" style="margin-top: 2px " >
                  <label>URL</label>
               </div>
                 <div class ="ui-g-2" style="margin-left: -74px" > 
                   <input name="url" type="text"  
                    autofocus required
                    pInputText [(ngModel)]="heathCheckMonData.url" ngModel />
               </div>
          
          
              <div class = "ui-g-2"   style="margin-left: 73px; margin-top: 2px" >
                    <label>User Name</label>
              </div>
              <div class = "ui-g-3" style="margin-left: -68px">
                   <input name="usrNme" type="text" 
                   pInputText [(ngModel)]="heathCheckMonData.user" ngModel />
              </div>
          
              
              <div class = "ui-g-2" style="margin-top: 2px" >
                  <label>Password</label>
            </div>
            <div class = "ui-g-3" style="margin-left: -81px">
                 <input name="psswrd" type="password" 
                 pInputText  [(ngModel)]="heathCheckMonData.pwd" ngModel />
            </div>
           </div>
          
            <div class = "ui-g-12">
              <p-accordion class="monitor-ui-accordion">
                <p-accordionTab header="Advanced Settings">
                   <div class = "ui-g-12">
                        <p-checkbox [(ngModel)]="heathCheckMonData.overideGlobalSettings"  name="overide" 
                           binary=true label="Override global health check settings"  (click)="overrideGlobalSettings(heathCheckMonData.overideGlobalSettings)" ></p-checkbox>
                    </div>
          
                    <div class = "ui-g-12" style= "border: 1px solid; margin-top: 10px"  *ngIf='heathCheckMonData.overideGlobalSettings && heathCheckMonData.healthCheckType == "Ping"'>
                        <div class="ui-g-2" style="margin-top: 2px">
                           <label>Packet Count</label>
                       </div>
                    <div class = "ui-g-3" style="margin-left: -53px;">
                         <input name="packet" type="number"  min="0" max="100"  pInputText [(ngModel)]="heathCheckMonData.pingPkt" autofocus required ngModel />
                   </div>
          
                 <div class = "ui-g-2" style="margin-top: 2px">
                      <label>Wait Interval in sec(s)</label>
               </div>
                 <div class ="ui-g-3">
                     <input name="interval" type="number" min="0" step="0.1" max="1" pInputText [(ngModel)]="heathCheckMonData.pingIntrvl"  ngModel />
              </div>
     </div>    
                       
       <div class = "ui-g-12" style= "border: 1px solid" *ngIf='heathCheckMonData.overideGlobalSettings &&heathCheckMonData.healthCheckType == "Socket"'>
                  
          <div class = "ui-g-2" style="margin-top: 2px" >
                <label>Connection Timeout in sec(s)</label>
            </div>
          <div class ="ui-g-3">
            <input name="connectionTimeOut" type="number"  pInputText [(ngModel)]="heathCheckMonData.sockeTo" 
             ngModel />
        </div>
        
      </div>     
     <div class= "ui-g-12" style= "border: 1px solid" *ngIf='heathCheckMonData.overideGlobalSettings && heathCheckMonData.healthCheckType == "Http"'>
                        <div class = "ui-g-12">
                            <div class = "ui-g-2">
                               <p-checkbox [(ngModel)]="heathCheckMonData.useProxy"  name="proxy" binary=true label="Use Proxy" ></p-checkbox>
                             </div>
                           </div>
                        
                          <div class= "ui-g-12" style=" margin-left: 13px">
                            <div class= "ui-g-12">
                              <div class="ui-g-2" style="margin-top: 2px" >
                                 <label>Proxy Host:Port </label>
                             </div>
                             <div class ="ui-g-2" style="margin-left: -47px">
                                <input name="url" type="text"  [disabled]="!heathCheckMonData.useProxy" pInputText [(ngModel)]="heathCheckMonData.httpUrl"   ngModel />
                             </div>
                        
                            <div class = "ui-g-2" style="margin-left: 46px;margin-top: 2px">
                                <label>User Name</label>
                            </div>
                            <div class ="ui-g-2" style="margin-left: -61px">
                                <input name="usrname" type="text"  [disabled]="!heathCheckMonData.useProxy" pInputText [(ngModel)]="heathCheckMonData.httpUser" 
                                pattern="^[a-zA-Z][a-zA-Z0-9_-]{0,31}$"  ngModel />
                            </div>
                        
                              <div class = "ui-g-2"  style="margin-left: 46px;margin-top: 2px">
                                  <label>Password</label>
                                </div>
                                <div class ="ui-g-2" style="margin-left: -61px">
                                    <input name="pswrd" type="password"  [disabled]="!heathCheckMonData.useProxy"
                                    pInputText [(ngModel)]="heathCheckMonData.httpPwd" 
                                     ngModel />
                                </div>
                            </div>
                          </div>
                        
                          <div class= "ui-g-12">
                              <div class = "ui-g-2" style="width: 25%;margin-top: 2px">
                                <label>Connection Timeout in sec(s)</label>
                              </div>
                              <div class ="ui-g-2" style="margin-left: -31px">
                                  <input name="cto" type="number"  pInputText style="width: 132px"
                                  [(ngModel)]="heathCheckMonData.httpCTO" ngModel />
                                <!-- <span>
                                    (sec)
                                </span> -->
                              </div>
                        
                                    
                              <div class = "ui-g-2"  style="margin-left: -26px; width: 24%;margin-top: 2px">
                                  <label>Response Timeout in sec(s)</label>
                                </div>
                                <div class ="ui-g-2" >
                                    <input name="rto" style="width: 118px; margin-left: -23px;" type="number"  pInputText  [(ngModel)]="heathCheckMonData.httpRTO"
                                    ngModel />
                                </div>
                      
                            </div>
                          
                          <div class= "ui-g-12" style="margin-left: 5px;margin-top: 2px">
                                <label>Status code for successful health check</label>
                            <span>
                                <input name="statusCode" type="text"  pInputText title="Comma separated list of status code"
                                [(ngModel)]="heathCheckMonData.httpSc" ngModel />
                            </span>
                          </div>      
                    </div>
                    </p-accordionTab>       
                  </p-accordion>   
                </div>
          
          
                <div class="ui-g-12" style="margin-top: 7px">
                    <button type="submit" pButton icon="fa-check" style="width: 63px ; float: right"  *ngIf="!editMode" label="Add"></button>
                    <button type="submit" pButton icon="fa-check" style="width: 63px ; float: right" *ngIf="editMode" label="Update"></button>
                    <button type="button" pButton icon="fa-close" style="width: 93px ; float: right" (click)="closeConfiguration()"  *ngIf="editMode" label="Cancel"></button>
                </div>
              </div>
            </p-fieldset>
            </form>

            <div class = "ui-g-12" style="margin-top: -3px">
                <p-treeTable  class = "healthChk-treeTable" [value]="heathCheckMonitorData"  selectionMode="single" [(selection)]="selectedFile">
                   <p-header class="health-check-mon-header">
                       <span >Configured Health Check Monitor</span>
                    </p-header>
               
                  <p-column field="nodeName" header="Monitor Name"></p-column>
                  <p-column field="arguments" header="Arguments">
                     <template let-col let-data="rowData" pTemplate>
                             <p-checkbox *ngIf="data.data['arguments'] == 'false' ||data.data['arguments'] == 'true'|| data.data['arguments'] == false ||data.data['arguments'] == true" 
                              [(ngModel)]="data.data.enabled "
                              (click)="onCheckBoxChange(data,data.data.enabled)"  binary="false">
               
                             </p-checkbox>   
                               <span *ngIf="!(data.data['arguments'] == 'false' ||data.data['arguments'] == 'true' || data.data['arguments'] == false ||data.data['arguments'] == true)" title="{{data.data['arguments']}}">{{data.data['arguments']}}</span>
                     </template>
                  </p-column>
                  
                  <p-column [style]="{'width':'80px'}" field="Actions" header="Actions">
                     <template  let-data="rowData" pTemplate type="body">
                         <span  (click)="deleteHealthMonData(data)">
                             <i class="fa fa-trash-o" style="color: #f12a2a;cursor:pointer; margin-left: 21px" title="Delete Configured Monitor"></i>
                         </span>
               
                         <span (click)="editHealthMonData(data)">
                           <i class="fa fa-pencil" *ngIf="!(data.data['arguments'] == 'false' ||data.data['arguments'] == 'true' || data.data['arguments'] == false ||data.data['arguments'] == true)" style="color: #2572b5;cursor:pointer;  margin-left: 10px" title="Edit Configured Data"></i>
                         </span>
                     </template>
                  </p-column>
               </p-treeTable>
               </div>
               
      </p-tabPanel>
            <div class="pull-right">
                <button type="button" pButton icon="fa-check" (click)= "saveFinalData()" label="Save"></button>
                <button type="button" pButton icon="fa-check"  label="Cancel"></button>
            </div>
  </p-tabView>

</p-dialog>